<!DOCTYPE html>
<html lang="en" itemscope="itemscope" itemtype="http://schema.org/WebPage">
<head>
    <meta charset="utf-8" />
    <title>MexApi: Slackware14, Apple MacBook Pro and audio quircks</title>

    <link rel="icon" href="http://mexapi.macpress.com.br/favicon.ico" sizes="16x16 24x24 32x32 57x57 64x64 72x72 96x96 110x110 114x114 128x128 195x195 256x256" type="image/vnd.microsoft.icon">

    <meta name="author" content="Deny Dias" />
    <meta name="description" itemprop="description" content="Deny Dias personal weblog. Includes his blog, links to his social accounts and resume. This is not an API." />
    <meta name="copyright" content="MexApi is licensed under CC BY-SA 3.0." />

    <link href="http://mexapi.macpress.com.br/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="MexApi RSS Feed" />
    <link href="http://mexapi.macpress.com.br/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="MexApi Atom Feed" />

    <!-- Mobile viewport optimized: j.mp/bplateviewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link rel="stylesheet" type="text/css" media="all" href="http://mexapi.macpress.com.br/theme/min-76d734ae.css" />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-43437542-1', 'macpress.com.br');
      ga('send', 'pageview');

    </script>
    <script src="http://mexapi.macpress.com.br/theme/js/libs/modernizr-2.6.2.min.js"></script>
</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1 class="sitesubtitle"><a href="http://mexapi.macpress.com.br">MexApi</a></h1>
                  <h4 class="sitesubtitle"><a href="http://mexapi.macpress.com.br"><strong>This is not an API</strong></a></h4>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="http://mexapi.macpress.com.br">Home</a></li>

                            <li><a href="http://mexapi.macpress.com.br/archives.html">Archives</a></li>
                            <li><a href="http://about.me/denydias">About Me</a></li>
                                                  
              </ul>
            </div>

          <section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="http://mexapi.macpress.com.br/2012/11/slackware14-apple-macbook-pro-and-audio.html" rel="bookmark"
                   title="Permalink to Slackware14, Apple MacBook Pro and audio quircks">Slackware14, Apple MacBook Pro and audio&nbsp;quircks</a></h2>
                      
            </header>
            <footer class="post-info">
              <abbr class="published" title="2012-11-23T12:53:00">
                Fri Nov 23 12:53:00 2012
              </abbr>
                            <address class="vcard author">
                By Deny Dias
              </address>
                          </footer><!-- /.post-info -->
                        <div class="entry-content">
              <p>My oh my! Audio was always a wierd thing to configure on Linux. Worst
it is when you are trying to make it work in an Apple MacBook Pro
(<a class="reference external" href="http://www.everymac.com/systems/apple/macbook_pro/specs/macbook-pro-core-2-duo-2.4-aluminum-13-mid-2010-unibody-specs.html">MacBook Pro 7,1</a>, Mid-2010, <span class="caps">MC374LL</span>/A, A1278 in my very own case).
Yet worst when it comes to Slackware Linux, where this particular area
is not very well documented as many others distributions out there
(don’t blame me, Slackers. It’s true). When it comes to the audio
matter, <a class="reference external" href="http://docs.slackware.com/howtos:hardware:audio_and_snd-hda-intel">Slackware Documentation Project</a>, Linux Questions [<a class="reference external" href="http://www.linuxquestions.org/questions/linux-hardware-18/slackware-13-sound-problem-791270/">1</a>]
[<a class="reference external" href="http://www.linuxquestions.org/questions/slackware-14/microphone-doesnt-record-on-slackware-14-0-a-4175437726/">2</a>], <a class="reference external" href="https://help.ubuntu.com/community/MacBookPro7-1/Maverick">Ubuntu Community Help Wiki</a> and <a class="reference external" href="http://www.google.com/">Google</a> are your friends,
but the best they can do is to give you some clues, <a class="reference external" href="http://www.flero.net/unlikely-saying-that-you-would-not-find-soda-saying/">Yoda style</a>.</p>
<p>This is a quick’n dirty guide on how to make audio work properly and
with minimal effort on Slackware (and possible others) and MacBook Pro
7,1 (ans possible others too). The bottom line: almost all audio
software infrastructure is already there when you finishes a
Slackware14’s fresh install and some configuration is needed to make it
work as it should.</p>
<p>Before we start, two words of advice:</p>
<ol class="arabic simple">
<li>Instead of just "follow the leader", try to understand what you are
doing, typing, whatever. Don’t hit the "comment" button at the end of
this post with silly questions. I’m experienced enough to now what
kind of user you are by just reading your words. If you don’t tried
to understand what you’re doing before ask, your comment/question is
going to be lost on the thin wires of the Internet. I’ll never reply
to you. Alas, this is true for anything technical you read from me.</li>
<li>As you may have noted at this point, I’m not a natural born English
speaker. I’m Brazilian and I had never, ever took English classes
beyond the high school (which are the most basic classes in Brazil,
for kids). I also don’t like to use an automated translator to help
me write in english because they feel, err, synthethic. If my English
sounds kinda redneck (which I’m, tks for ask) and it does bothers
you, feel free to positively criticize me. If you hit the "comment"
button just to let me know that my "English is bad", don’t bother to.
I know that already. So, just fuck off while I keep writing the
articles that I think may help a broader audience with my bad
English, which I think is just good enough to transmit an idea, which
in turns is the most basic concept on communication.</li>
</ol>
<p>Across this article there will be specific Apple MacBook Pro 7,1
[<span class="caps">MBP71</span>] tips and most general [G] ones. The general tips could apply to
Slackware and other Linux flavors also. I’ll let you know the difference
during the reading by using the aforementioned tags.</p>
<div class="section" id="step-1-mbp71-just-after-install-finishes-set-the-proper-kernel-module-configuration">
<h2>Step 1 [<span class="caps">MBP71</span>] : Just after install finishes, set the proper kernel module configuration</h2>
<pre class="code bash literal-block">
<span class="nv">$ </span>sudo vi /etc/modprobe.d/alsa-base.conf
  options snd-hda-intel <span class="nv">model</span><span class="o">=</span>mbp55
</pre>
<p>Reboot your system. Sorry.</p>
</div>
<div class="section" id="step-2-g-set-alsa-mixer-and-store-its-settings">
<h2>Step 2 [G]: Set <span class="caps">ALSA</span> mixer and store its settings</h2>
<p>Run <tt class="docutils literal">alsamixer</tt> on your term. The first screen shows the playback
controls. Unmute all of them but S/<span class="caps">PDIF</span> (unless you acutally have
optical audio cables connected to your receiver or want a red light
coming out of your headphone jack on MacBook Pro). Set the volumes to
the max.</p>
<p>Hit <tt class="docutils literal">tab</tt> (or <tt class="docutils literal">F4</tt>) to go to capture settings. If <tt class="docutils literal">Capture</tt> reads
<tt class="docutils literal"><span class="pre">-------</span></tt> above it, it’s muted. Select it with arrow keys (it turns red
when selected) and hit space to unmute it (should read <tt class="docutils literal"><span class="caps">CAPTURE</span></tt> instead
of dashes).</p>
<p>Now run the command bellow to store your settings so they come alive
between reboots. Note to run it as user ($), not as root (#), as you
want to store the mixers settings for your user.</p>
<pre class="code console literal-block">
<span class="gp">$</span> /usr/sbin/alsactl store
</pre>
</div>
<div class="section" id="step-3-g-avoid-kmix-to-mess-with-your-alsa-mixer-setting">
<h2>Step 3 [G]: Avoid KMix to mess with your <span class="caps">ALSA</span> mixer setting</h2>
<p>When you store the mixer settings with <tt class="docutils literal">alsactl store</tt>, the expected
behavior when you reboot is to have the exact same settings that you
manually stored before, loaded again. Some distros stores <span class="caps">ALSA</span> mixer
settings upon shutdown/reboot (i.e Arch), but Slackware seems to not do
it. If you’d like, it’s easy enough to add the <tt class="docutils literal">/usr/sbin/alsactl store</tt>
command to your <tt class="docutils literal"><span class="pre">~/.bash\_logout</span></tt> script so it
make this happen automatically. It didn’t bother me, so I don’t.</p>
<p>For the ones that uses <span class="caps">KDE</span> as their window manager (I do), KMix has a
<a class="reference external" href="https://bugs.kde.org/show_bug.cgi?id=293043">bug</a> (fixed on <span class="caps">KDE</span> 4.9.0, Slackware14’s is 4.8.5) on session restore
feature that prevents it to "remember" the levels from its last session.
The most annoyng part is that you have to remember to always open KMix
before a video call on Gtalk, Skype and others, because the capture
devices are going to be always muted and set to 0.</p>
<p>There’s an easy <a class="reference external" href="https://bugs.kde.org/show_bug.cgi?id=293043#c22">workaround</a> for this, though. Go to <tt class="docutils literal">KMix &gt; Settings
&gt; Configure KMix</tt>  and uncheck <tt class="docutils literal">Restore volumes upon login</tt>.</p>
</div>
<div class="section" id="step-4-mbp71-fix-apple-shit-on-microphone-audio-routing">
<h2>Step 4 [<span class="caps">MBP71</span>]: Fix Apple shit on microphone audio routing</h2>
<p class="warning label">Note</p>
<p>This is for Skype only. Gtalk is smart enough to fix this
internally. Tks, Google devs!</p>
<p>Generally speaking, notebook microphones are mono devices. They
capture audio at one channel only instead the two for the stereo sound.
That’s just fine from the engineering perspective for the kind of
application that a built-in notebook mic has.</p>
<p>When it comes to audio, there’s a <em>de facto</em> <a class="reference external" href="http://en.wikipedia.org/wiki/Phone_connector_(audio)#Switch_contacts">standard</a>: mono audio
sources, when connected to stereo devices, have the live channel (the
one that carries the signal) as the left channel while the right channel
is unused. Right? Not to Apple, you bitch!</p>
<p>Apple did us the favor to reverse this connection on their notebooks
and one could have very interesting times wondering what is happening to
the microphone audio capture (as I did). To solve this shit (many thanks
to <a class="reference external" href="https://wiki.archlinux.org/index.php/Skype">Arch Linux Skype Wiki page</a> maintainers to give me the clues for this):</p>
<pre class="code bash literal-block">
<span class="nv">$ </span>vi ~/.asoundrc
  pcm.skype <span class="o">{</span>
    <span class="nb">type </span>route
    slave.pcm <span class="s2">"hw:0,0"</span>
    slave.channels 2
    ttable.0.1 4
    ttable.1.0 0
  <span class="o">}</span>
</pre>
<p>After save the file, logout and login from X, go to <tt class="docutils literal">Skype &gt; Options &gt;
Audio &gt; Microphone</tt> and select the new device in the list: <tt class="docutils literal">skype (route)</tt>.
Make an Skype call to the echo test service (echo123) to check that’s
working. If it’s not, double check steps 2 and 3. Done. Your voice
spreading to the world. Talk soft, smart things.</p>
</div>
<div class="section" id="step-5-g-dumb-amarok">
<h2>Step 5 [G]: Dumb Amarok</h2>
<p>Finally, Amarok (the default playlist based music player in <span class="caps">KDE</span>) do not
work out of the box on Slackware14. Thanks to <a class="reference external" href="http://itaman.blogspot.com.br/2012/10/pequeno-comentario-sobre-o-slackware.html">Itaman Cavalcanti</a>, who
pointed out a solution for this issue, here’s how to make Amarok plays
your tunes.</p>
<p>First, download OpenSUSE’s <a class="reference external" href="http://pkgs.org/download/gstreamer-0_10-plugins-fluendo_mp3">gstreamer-0_10-plugins-fluendo_mp3</a> rpm
package. Note to download the right file for your <span class="caps">CPU</span> architecture (i586
for 32bit, X86_64 for 64bit). Then issue on terminal:</p>
<pre class="code console literal-block">
<span class="gp">$</span> rpm2txz gstreamer-0_10-plugins-fluendo_mp3-<span class="o">[</span><span class="caps">VERSION</span><span class="o">]</span>.<span class="o">[</span><span class="caps">ARCH</span><span class="o">]</span>.rpm
<span class="gp">$</span> sudo /sbin/installpkg gstreamer-0_10-plugins-fluendo_mp3-<span class="o">[</span><span class="caps">VERSION</span><span class="o">]</span>.<span class="o">[</span><span class="caps">ARCH</span><span class="o">]</span>.txz
</pre>
<p>Of course, <tt class="docutils literal">[<span class="caps">VERSION</span>]</tt> and <tt class="docutils literal">[<span class="caps">ARCH</span>]</tt> must be replaced with your needs.
Almost done, lets make Amarok play <span class="caps">MPEG</span>-4 <span class="caps">AAC</span> audio files (I came from
a Mac, so I have a bunch of these around) and make it able to transcode things:</p>
<pre class="code console literal-block">
<span class="gp">$</span> sbopkg -i <span class="s2">"gst-plugins-ugly gst-plugins-bad gst-ffmpeg"</span>
</pre>
<p>Restart Amarok and you’re good to go.</p>
</div>
<div class="section" id="wrap-up">
<h2>Wrap up</h2>
<p>From the end user perspective, we’ve learned here how to make
Slackware14 be a good guy when it comes to audio. We also learned how to
properly configure audio in Slacware14 to the Apple’s Macbook Pro 7,1
(Mid-2010) specifics wierdness.</p>
<p>Doubts, comments? The channel is open. Be my guest.</p>
</div>
<div class="section" id="bonus-paloma-faith-do-you-want-the-truth-or-something-beautiful-the-roots-version">
<h2><strong>Bonus</strong>: Paloma Faith - Do You Want the Truth or Something Beautiful (the roots version)</h2>
<div align="center" class="youtube"><iframe frameborder="0" height="281" src="https://www.youtube.com/embed/TskmeMoUh-8" width="500"></iframe></div></div>

            </div><!-- /.entry-content -->
            <div class="share">
              <hr class="share-before">
              <h3>Word of Mouth</h3>
              <!-- AddThis Button BEGIN -->
              <div class="addthis_toolbox addthis_default_style">
                <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
                <a class="addthis_button_tweet"></a>
                <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
              </div>
              <script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
              <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-52210248541aab63"></script>
              <!-- AddThis Button END -->
            </div><!-- /.share -->
            <div class="related">
              <h3>Related Posts</h3>
                              <ul>
                                    <li><i class="icon-doc-text-inv"></i><a href="http://mexapi.macpress.com.br/2012/11/subversao-tecnologica-do-mac-os-x-para.html">Subversão tecnológica: do Mac <span class="caps">OS</span> X para o Slackware Linux em um Apple MacBook&nbsp;Pro</a></li>
                                      <li><i class="icon-doc-text-inv"></i><a href="http://mexapi.macpress.com.br/2013/08/moving-slackware-to-kernel-310-fixes-to.html">Moving Slackware to kernel 3.10: <span class="caps">NVIDIA</span> and Broadcom drivers&nbsp;fixes</a></li>
                                      <li><i class="icon-doc-text-inv"></i><a href="http://mexapi.macpress.com.br/2012/12/a-beleza-o-prazer-e-ironia-do.html">A beleza, o prazer e a ironia do conhecimento&nbsp;livre</a></li>
                                      <li><i class="icon-doc-text-inv"></i><a href="http://mexapi.macpress.com.br/2013/04/time-machineish-backups-under-linux.html">Time Machine&#8217;ish backups under&nbsp;Linux</a></li>
                                  </ul>
                            <hr class="related-after">
            </div><!-- /.related -->
                        <div class="comments">
              <h3>Comments</h3>
              <div id="disqus_thread"></div>
              <script type="text/javascript">
                var disqus_identifier = "2012/11/slackware14-apple-macbook-pro-and-audio.html";
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://mexapi.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
              </script>
            </div>
            

        </div><!-- /.eleven.columns -->
        
     <div class="three columns">


<h4>Categories</h4>
<ul>
			<li><i class="icon-plus-squared"></i><a href="http://mexapi.macpress.com.br/category/development.html">Development</a></li>
			<li><i class="icon-plus-squared"></i><a href="http://mexapi.macpress.com.br/category/music.html">Music</a></li>
			<li><i class="icon-plus-squared"></i><a href="http://mexapi.macpress.com.br/category/politics.html">Politics</a></li>
			<li><i class="icon-plus-squared"></i><a href="http://mexapi.macpress.com.br/category/slackware.html">Slackware</a></li>
			<li><i class="icon-plus-squared"></i><a href="http://mexapi.macpress.com.br/category/society.html">Society</a></li>
	</ul>


<h4>Tags</h4>
	<ul>
		    <li class="tag-2"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/revolucao.html">revolução</a></li>
		    <li class="tag-1"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/tecnologia.html">tecnologia</a></li>
		    <li class="tag-1"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/slackware.html">Slackware</a></li>
		    <li class="tag-2"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/subversao.html">subversão</a></li>
		    <li class="tag-1"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/etica.html">ética</a></li>
		    <li class="tag-2"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/development.html">development</a></li>
		    <li class="tag-1"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/linux.html">Linux</a></li>
		    <li class="tag-1"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/vida.html">vida</a></li>
		    <li class="tag-2"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/utopia.html">utopia</a></li>
		    <li class="tag-2"><i class="icon-tag"></i><a href="http://mexapi.macpress.com.br/tag/software.html">software</a></li>
	</ul>



</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">
                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>. MexApi is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" target="_blank">CC BY-SA 3.0</a>.
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">

                                <li><div class="btn primary"><a href="https://github.com/denydias" target="_blank">Github</a></div></li>
                
                                <li><div class="btn twitter"><a href="https://twitter.com/denydias" target="_blank">Twitter</a></div></li>
                
                
                                <li><div class="btn danger"><a href="https://plus.google.com/104343775245895695882" target="_blank">Google+</a></div></li>
                
              </ul>
            </div>
          </div>
        </footer>

    </div>

<script type="text/javascript">
    var disqus_shortname = 'mexapi';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
  <script src="http://mexapi.macpress.com.br/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="http://mexapi.macpress.com.br/theme/js/libs/gumby.min.js"></script>
  <script src="http://mexapi.macpress.com.br/theme/js/plugins.js"></script>
  <script type="text/javascript">
    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>

</body>
</html>